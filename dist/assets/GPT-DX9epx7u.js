import{d as $,r as n,w as z,o as F,c as l,a as e,F as y,b as f,t as d,e as w,v as T,f as I,g as P,h as S,i as A,n as D,j as r,k as x,_ as K}from"./main-ClaGD0qK.js";const U={class:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-purple-50"},H={class:"container mx-auto px-4 py-8"},O={class:"flex space-x-6"},q={class:"w-64 space-y-4"},J={class:"bg-white rounded-xl shadow-sm p-4"},L={class:"space-y-2"},Q=["onClick"],Y={class:"flex items-center space-x-3"},Z={class:"bg-white rounded-xl shadow-sm p-4"},R={class:"space-y-4"},W={class:"block text-sm font-medium text-gray-700 mb-1"},X={class:"bg-white rounded-xl shadow-sm p-4"},ee={class:"space-y-2"},te=["onClick"],se={class:"flex-1 bg-white rounded-xl shadow-lg overflow-hidden"},oe={class:"whitespace-pre-wrap"},ae={class:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity"},ne=["onClick"],le={key:0,class:"flex justify-start"},re={class:"border-t border-gray-200 p-4"},ie={class:"flex space-x-4"},de=["onKeydown"],ce={class:"flex flex-col space-y-2"},ue=["disabled"],pe={class:"w-64 bg-white rounded-xl shadow-sm p-4"},ve={class:"space-y-2"},ge=["onClick"],me={class:"text-sm font-medium text-gray-700 truncate"},ye={class:"text-xs text-gray-500"},fe={key:0,class:"max-w-4xl mx-auto mt-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700"},xe="sk-T6c5Bwnz67laZdm68f4411Ed73F942438fF9Bf543b34C933",be=$({__name:"GPT",setup(he){const _=[{id:"gpt-3.5-turbo",name:"GPT-3.5",icon:"fas fa-bolt"},{id:"gpt-4",name:"GPT-4",icon:"fas fa-brain"}],M=["帮我解释一下这段代码","这个问题如何优化？","给我一些建议","用更简单的方式解释"],i=n(""),c=n([]),u=n(!1),p=n(""),v=n(null),b=n(_[0]),g=n(.7),h=n(2e3),j=n([{title:"上一次对话",date:"2024-03-20 15:30"},{title:"代码优化讨论",date:"2024-03-19 10:15"}]),B=o=>{b.value=o},E=o=>{i.value=o},G=async o=>{try{await navigator.clipboard.writeText(o)}catch(t){console.error("复制失败:",t)}},N=()=>{confirm("确定要清空当前对话吗？")&&(c.value=[])},V=o=>{console.log("加载对话:",o)},k=async()=>{if(i.value.trim())try{u.value=!0,p.value="",c.value.push({role:"user",content:i.value});const o=i.value;i.value="",await m();const t=await fetch("https://api.xty.app/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${xe}`},body:JSON.stringify({model:b.value.id,messages:[{role:"system",content:"You are a helpful assistant."},...c.value.map(a=>({role:a.role,content:a.content}))],temperature:Number(g.value),max_tokens:Number(h.value)})});if(!t.ok){const a=await t.json();throw new Error(a.message||"API 请求失败")}const s=await t.json();if(s.error)throw new Error(s.error.message||"获取回复失败");c.value.push({role:"assistant",content:s.choices[0].message.content}),await m()}catch(o){p.value=o instanceof Error?o.message:"发生错误，请稍后重试",console.error("GPT API 错误:",o)}finally{u.value=!1}},m=async()=>{await D(),v.value&&(v.value.scrollTop=v.value.scrollHeight)};return z(c,()=>{m()},{deep:!0}),F(()=>{m()}),(o,t)=>(r(),l("div",U,[e("div",H,[e("div",O,[e("div",q,[e("div",J,[t[3]||(t[3]=e("h3",{class:"text-lg font-medium text-gray-800 mb-4"},"模型选择",-1)),e("div",L,[(r(),l(y,null,f(_,s=>e("button",{key:s.id,onClick:a=>B(s),class:x(["w-full p-3 rounded-lg text-left transition-all relative",b.value.id===s.id?"bg-indigo-50 text-indigo-700":"hover:bg-gray-50 text-gray-600"])},[e("div",Y,[e("i",{class:x(s.icon)},null,2),e("span",null,d(s.name),1)])],10,Q)),64))])]),e("div",Z,[t[6]||(t[6]=e("h3",{class:"text-lg font-medium text-gray-800 mb-4"},"对话设置",-1)),e("div",R,[e("div",null,[e("label",W," 温度 ("+d(g.value)+") ",1),w(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),type:"range",min:"0",max:"2",step:"0.1",class:"w-full"},null,512),[[T,g.value]])]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," 最大长度 ",-1)),w(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>h.value=s),class:"w-full rounded-lg border-gray-300"},t[4]||(t[4]=[e("option",{value:"1000"},"1000 tokens",-1),e("option",{value:"2000"},"2000 tokens",-1),e("option",{value:"4000"},"4000 tokens",-1)]),512),[[I,h.value]])])])]),e("div",X,[t[7]||(t[7]=e("h3",{class:"text-lg font-medium text-gray-800 mb-4"},"快捷提示语",-1)),e("div",ee,[(r(),l(y,null,f(M,(s,a)=>e("button",{key:a,onClick:C=>E(s),class:"w-full p-2 rounded-lg text-left hover:bg-gray-50 transition-colors text-sm text-gray-600"},d(s),9,te)),64))])])]),e("div",se,[e("div",{class:"h-[600px] overflow-y-auto p-6 space-y-4",ref_key:"chatContainer",ref:v},[(r(!0),l(y,null,f(c.value,(s,a)=>(r(),l("div",{key:a,class:x(["flex",s.role==="user"?"justify-end":"justify-start"])},[e("div",{class:x(["max-w-[80%] rounded-lg p-4 relative group",s.role==="user"?"bg-indigo-500 text-white rounded-br-none":"bg-gray-100 text-gray-800 rounded-bl-none"])},[e("div",oe,d(s.content),1),e("div",ae,[e("button",{onClick:C=>G(s.content),class:"p-1 hover:bg-black/10 rounded",title:"复制"},t[8]||(t[8]=[e("i",{class:"fas fa-copy text-xs"},null,-1)]),8,ne)])],2)],2))),128)),u.value?(r(),l("div",le,t[9]||(t[9]=[e("div",{class:"bg-gray-100 rounded-lg p-4 flex items-center space-x-2"},[e("div",{class:"w-2 h-2 bg-gray-500 rounded-full animate-bounce"}),e("div",{class:"w-2 h-2 bg-gray-500 rounded-full animate-bounce",style:{"animation-delay":"0.2s"}}),e("div",{class:"w-2 h-2 bg-gray-500 rounded-full animate-bounce",style:{"animation-delay":"0.4s"}})],-1)]))):P("",!0)],512),e("div",re,[e("div",ie,[w(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=s=>i.value=s),rows:"3",class:"flex-1 resize-none border rounded-lg p-3 focus:ring-2 focus:ring-indigo-500 focus:border-transparent",placeholder:"输入你的问题...",onKeydown:S(A(k,["prevent"]),["enter"])},null,40,de),[[T,i.value]]),e("div",ce,[e("button",{onClick:k,disabled:u.value||!i.value.trim(),class:"px-6 py-3 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed"},t[10]||(t[10]=[e("i",{class:"fas fa-paper-plane"},null,-1)]),8,ue),e("button",{onClick:N,class:"px-6 py-3 bg-gray-100 text-gray-600 rounded-lg hover:bg-gray-200",title:"清空对话"},t[11]||(t[11]=[e("i",{class:"fas fa-trash"},null,-1)]))])])])]),e("div",pe,[t[12]||(t[12]=e("h3",{class:"text-lg font-medium text-gray-800 mb-4"},"对话历史",-1)),e("div",ve,[(r(!0),l(y,null,f(j.value,(s,a)=>(r(),l("div",{key:a,class:"p-3 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:C=>V(s)},[e("div",me,d(s.title),1),e("div",ye,d(s.date),1)],8,ge))),128))])])]),p.value?(r(),l("div",fe,d(p.value),1)):P("",!0)])]))}}),_e=K(be,[["__scopeId","data-v-8e2b1fbc"]]);export{_e as default};
