import{d as Q,r as m,l as _,o as W,m as Y,c as n,a as e,t as l,F as g,p as z,b as w,u as k,q as Z,s as q,j as i,k as f,g as C,_ as ee}from"./main-ClaGD0qK.js";const te={class:"min-h-screen bg-gray-50"},se={class:"container mx-auto px-4 py-8"},re={key:0,class:"flex flex-col items-center justify-center py-12"},ae={key:1,class:"flex flex-col items-center justify-center py-12"},oe={class:"text-gray-600 mb-4"},le={class:"bg-white rounded-lg shadow-lg p-8 mb-8"},ne={class:"text-center"},ie={class:"text-gray-600 mb-6"},ce={class:"flex justify-center items-center space-x-4"},de={class:"flex items-center space-x-2"},ue={class:"flex items-center space-x-2"},me={class:"flex justify-center items-center space-x-12 mt-8"},fe={class:"text-center transform hover:scale-105 transition-transform"},pe={class:"text-5xl font-bold text-indigo-600 mb-2 animate-number"},xe={class:"text-center transform hover:scale-105 transition-transform"},ge={class:"text-5xl font-bold text-green-600 mb-2 animate-number"},ve={class:"text-center transform hover:scale-105 transition-transform"},ye={class:"text-5xl font-bold text-red-600 mb-2 animate-number"},be={class:"mt-8 max-w-md mx-auto"},he={class:"text-sm text-gray-600 mb-2"},_e={class:"h-4 bg-gray-200 rounded-full overflow-hidden"},we={class:"mt-8 max-w-2xl mx-auto"},Ce={class:"grid grid-cols-2 gap-4"},je={class:"text-sm text-gray-600 mb-2"},Te={class:"flex items-center space-x-2"},ke={class:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden"},Se={class:"text-sm font-medium text-gray-700"},Ie={class:"bg-white rounded-lg shadow-lg p-8"},Ne={class:"space-y-6"},Pe={class:"flex items-center justify-between mb-4"},De={class:"flex items-center space-x-3"},Ee={class:"text-lg font-medium"},$e={class:"flex space-x-2"},Ae={class:"mb-4"},Oe={class:"text-gray-800 font-medium mb-2"},Fe={class:"space-y-2 mt-4"},Le={class:"flex items-center space-x-3 flex-1"},Re={class:"text-gray-700"},ze={class:"flex items-center space-x-4"},Be={key:1,class:"flex items-center space-x-2 px-3 py-1 bg-green-50 text-green-700 rounded-full text-sm"},Je={key:0,class:"mt-4 p-4 bg-red-50 rounded-lg border border-red-200"},Me={class:"text-red-800 space-y-2"},Ue={class:"flex items-center space-x-2"},Ve={class:"flex items-center space-x-2"},Ke={key:1,class:"mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200"},Xe={class:"text-blue-800"},Ge={class:"flex justify-center space-x-4 mt-8"},He=3,Qe=Q({__name:"PracticeSummary",setup(We){const S=Z(),p=q(),c=m([]),v=m(!1),x=m(null),y=_(()=>c.value.filter(r=>r.isCorrect===1).length),B=_(()=>c.value.length-y.value),J=_(()=>Math.round(y.value/c.value.length*100)),I=_(()=>(y.value/c.value.length*100).toFixed(1)),M=async(r,t,s)=>{try{const d=await(await fetch("http://localhost:3013/practice/detail/getSubjectDetail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({practiceId:r,subjectId:t,subjectType:s})})).json();if(d.success)return d.data;throw new Error(d.message||"获取题目详情失败")}catch(a){return console.error("获取题目详情失败:",a),null}},N=m(""),P=m(""),D=m({}),U=r=>{const t=r.slice(0,2),s=r.slice(2,4),a=r.slice(4,6);return`${t}:${s}:${a}`},V=r=>new Date(r).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),K=()=>{const r={};c.value.forEach(t=>{var s;(s=t.detail)==null||s.labelNames.forEach(a=>{r[a]||(r[a]={total:0,correct:0,accuracy:0}),r[a].total++,t.isCorrect===1&&r[a].correct++})}),Object.values(r).forEach(t=>{t.accuracy=Number((t.correct/t.total*100).toFixed(1))}),D.value=r},j=async()=>{try{if(x.value=null,v.value=!0,!p.query.practiceId)throw new Error("缺少练习ID");const t=await(await fetch("http://localhost:3013/practice/detail/getScoreDetail",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({practiceId:Number(p.query.practiceId)})})).json();if(t.success){c.value=t.data;const d=c.value.map(u=>M(Number(p.query.practiceId),u.subjectId,u.subjectType)),b=await Promise.all(d);c.value.forEach((u,h)=>{u.detail=b[h]})}else throw new Error(t.message||"获取成绩详情失败");const a=await(await fetch("http://localhost:3013/practice/detail/getPracticeInfo",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({practiceId:Number(p.query.practiceId)})})).json();a.success&&(N.value=a.data.timeUse,P.value=a.data.submitTime),K()}catch(r){console.error("获取成绩详情失败:",r),r.value=r instanceof Error?r.message:"请重试"}finally{v.value=!1}},T=m(0),X=async()=>{if(T.value>=He){x.value="获取数据失败，请刷新页面重试";return}T.value++,await new Promise(r=>setTimeout(r,1e3*T.value)),await j()};W(()=>{j().catch(()=>{X()})}),Y(()=>{x.value=null,v.value=!1,c.value=[]});const G=(r=[])=>!r||r.length===0?"未作答":r.sort((t,s)=>t-s).map(t=>String.fromCharCode(64+t)).join("、"),H=(r=[])=>!r||r.length===0?"暂无答案":r.filter(t=>t.isCorrect===1).sort((t,s)=>t.optionType-s.optionType).map(t=>String.fromCharCode(64+t.optionType)).join("、");return(r,t)=>(i(),n("div",te,[e("div",se,[v.value?(i(),n("div",re,t[2]||(t[2]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-4 border-indigo-500 border-t-transparent"},null,-1),e("p",{class:"mt-4 text-gray-600"},"加载中...",-1)]))):x.value?(i(),n("div",ae,[t[3]||(t[3]=e("div",{class:"text-red-500 mb-4"},[e("i",{class:"fas fa-exclamation-circle text-4xl"})],-1)),e("p",oe,l(x.value),1),e("button",{onClick:j,class:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors"}," 重试 ")])):(i(),n(g,{key:2},[e("div",le,[e("div",ne,[t[10]||(t[10]=e("h1",{class:"text-2xl font-bold text-gray-900 mb-2"},"练习总结",-1)),e("div",ie,[e("div",ce,[e("div",de,[t[4]||(t[4]=e("i",{class:"fas fa-clock"},null,-1)),e("span",null,"用时："+l(U(N.value)),1)]),e("div",ue,[t[5]||(t[5]=e("i",{class:"fas fa-calendar"},null,-1)),e("span",null,"完成时间："+l(V(P.value)),1)])])]),e("div",me,[e("div",fe,[e("div",pe,l(J.value)+"分",1),t[6]||(t[6]=e("div",{class:"text-gray-600"},"总分",-1))]),e("div",xe,[e("div",ge,l(y.value),1),t[7]||(t[7]=e("div",{class:"text-gray-600"},"正确题数",-1))]),e("div",ve,[e("div",ye,l(B.value),1),t[8]||(t[8]=e("div",{class:"text-gray-600"},"错误题数",-1))])]),e("div",be,[e("div",he,"正确率："+l(I.value)+"%",1),e("div",_e,[e("div",{class:"h-full bg-gradient-to-r from-green-500 to-green-600 transition-all duration-1000",style:z({width:`${I.value}%`})},null,4)])]),e("div",we,[t[9]||(t[9]=e("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"知识点掌握情况",-1)),e("div",Ce,[(i(!0),n(g,null,w(D.value,(s,a)=>(i(),n("div",{key:a,class:"bg-gray-50 rounded-lg p-4"},[e("div",je,l(a),1),e("div",Te,[e("div",ke,[e("div",{class:"h-full bg-indigo-600 transition-all duration-1000",style:z({width:`${s.accuracy}%`})},null,4)]),e("span",Se,l(s.accuracy)+"% ",1)])]))),128))])])])]),e("div",Ie,[t[17]||(t[17]=e("h2",{class:"text-xl font-bold text-gray-900 mb-6"},"答题详情",-1)),e("div",Ne,[(i(!0),n(g,null,w(c.value,(s,a)=>{var d,b,u,h,E,$;return i(),n("div",{key:a,class:f(["p-6 rounded-lg transform hover:-translate-y-1 transition-all duration-300",s.isCorrect?"bg-green-50":"bg-red-50"])},[e("div",Pe,[e("div",De,[e("span",Ee,"第 "+l(a+1)+" 题",1),e("span",{class:f({"px-3 py-1 rounded-full text-sm font-medium flex items-center space-x-1":!0,"bg-green-100 text-green-800":s.isCorrect,"bg-red-100 text-red-800":!s.isCorrect})},[e("i",{class:f(["fas",s.isCorrect?"fa-check":"fa-times"])},null,2),e("span",null,l(s.isCorrect?"正确":"错误"),1)],2),e("div",$e,[(i(!0),n(g,null,w((d=s.detail)==null?void 0:d.labelNames,o=>(i(),n("span",{key:o,class:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full"},l(o),1))),128))])])]),e("div",Ae,[e("h3",Oe,l((b=s.detail)==null?void 0:b.subjectName),1),e("div",Fe,[(i(!0),n(g,null,w((u=s.detail)==null?void 0:u.optionList,o=>{var A,O,F,L,R;return i(),n("div",{key:o.optionType,class:f(["flex items-center p-3 rounded-lg transition-all duration-300",{"bg-green-100 border-2 border-green-200":o.isCorrect===1,"bg-red-100 border-2 border-red-200":((A=s.detail)==null?void 0:A.respondAnswer.includes(o.optionType))&&o.isCorrect===0,"bg-gray-50 border border-gray-200":!((O=s.detail)!=null&&O.respondAnswer.includes(o.optionType))&&o.isCorrect===0}])},[e("div",Le,[e("div",{class:f(["w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium",{"bg-green-500 text-white":o.isCorrect===1,"bg-red-500 text-white":(F=s.detail)==null?void 0:F.respondAnswer.includes(o.optionType),"bg-gray-200 text-gray-600":!((L=s.detail)!=null&&L.respondAnswer.includes(o.optionType))&&o.isCorrect===0}])},l(String.fromCharCode(64+o.optionType)),3),e("span",Re,l(o.optionContent),1)]),e("div",ze,[(R=s.detail)!=null&&R.respondAnswer.includes(o.optionType)?(i(),n("div",{key:0,class:f(["flex items-center space-x-2 px-3 py-1 rounded-full text-sm",o.isCorrect===1?"bg-green-50 text-green-700":"bg-red-50 text-red-700"])},t[11]||(t[11]=[e("i",{class:"fas fa-user"},null,-1),e("span",null,"你的选择",-1)]),2)):C("",!0),o.isCorrect===1?(i(),n("div",Be,t[12]||(t[12]=[e("i",{class:"fas fa-check"},null,-1),e("span",null,"正确答案",-1)]))):C("",!0)])],2)}),128)),s.isCorrect?C("",!0):(i(),n("div",Je,[t[15]||(t[15]=e("div",{class:"flex items-center space-x-2 text-red-700 mb-2"},[e("i",{class:"fas fa-exclamation-circle"}),e("span",{class:"font-medium"},"错误分析")],-1)),e("div",Me,[e("div",Ue,[t[13]||(t[13]=e("i",{class:"fas fa-times-circle text-sm"},null,-1)),e("span",null,"你的答案："+l(G((h=s.detail)==null?void 0:h.respondAnswer)),1)]),e("div",Ve,[t[14]||(t[14]=e("i",{class:"fas fa-check-circle text-green-600 text-sm"},null,-1)),e("span",null,"正确答案："+l(H((E=s.detail)==null?void 0:E.optionList)),1)])])])),($=s.detail)!=null&&$.subjectParse?(i(),n("div",Ke,[t[16]||(t[16]=e("div",{class:"flex items-center space-x-2 text-blue-700 mb-2"},[e("i",{class:"fas fa-lightbulb"}),e("span",{class:"font-medium"},"解析：")],-1)),e("p",Xe,l(s.detail.subjectParse),1)])):C("",!0)])])],2)}),128))])]),e("div",Ge,[e("button",{onClick:t[0]||(t[0]=s=>k(S).push("/practice")),class:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2"},t[18]||(t[18]=[e("i",{class:"fas fa-list"},null,-1),e("span",null,"返回列表",-1)])),e("button",{onClick:t[1]||(t[1]=s=>k(S).push(`/practice/${k(p).params.id}`)),class:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors flex items-center space-x-2"},t[19]||(t[19]=[e("i",{class:"fas fa-redo"},null,-1),e("span",null,"重新练习",-1)]))])],64))])]))}}),Ze=ee(Qe,[["__scopeId","data-v-43e66a05"]]);export{Ze as default};
